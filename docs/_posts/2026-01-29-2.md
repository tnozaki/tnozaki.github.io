---  
date: 2026-01-29 00:00:02 +0900
layout: post
tags:      
  - pkgsrc
  - libarchive
  - GNU make
title: pkgsrc/archivers/bsdtar がビルド中に GNU make 依存の所作でハングアップする
---

[libarchive](https://www.libarchive.org/)
への
[このコミット](https://github.com/libarchive/libarchive/commit/fdec8c2f249561a785cdf1471568228b573c6f05)
により 「GNU」 make 依存の
[`$^`](https://www.gnu.org/software/make/manual/html_node/Automatic-Variables.html#index-_0024_005e)
(PMake でいうとこの `${.ALLSRC}`) が紛れ込んだせいで 「BSD」 tar のビルドで変数が展開されず空になり

```
grep -h '^DEFINE_TEST('  | LC_COLLATE=C sort > cat/test/list.h
```

と grep が永遠に標準入力を待ち続けてハングアップする始末で、BSD とは何ぞやという皮肉な気持ちになっている。

ああもう日本では 20 年前に
[コスプレ居酒屋](https://x.com/little_bsd)
に書き換えられてましたな、つーかつい最近まで営業してて驚いた。

このバグどっからも問題報告のないまま早一月経過してるんだけどもしかして N HEAD の make で `$^` って実装されてたりするんですかね。

もちろん pkgsrc/devel/bmake はこんな GNU 訛りをサポートしとらんので bootstrap-pkgsrc 使おうとしてもブートストラップビルドが通らん始末、誰も困ってないってことは誰も使ってないんだなって。

いちおうオレオレ pkgsrc の方には
[修正いれといた](https://bitbucket.org/tnozaki/pkgsrc/commits/b046961162dc)
が後は知らん。

(追記) 上の修正だと オレオレ N6 なら問題ないけど openSUSE Tumbleweed で作った bmake だとやっぱり変数展開されなくてハングアップするわ、なんじゃこりゃ。

(追記2) openSUSE Tumbleweed 問題は幻覚だったっぽい。
